# .github/workflows/rss_fetcher.yml

name: RSS News Fetcher (å®šæ—¶æŠ“å–æ–°é—»)

# --- 1. è§¦å‘å™¨é…ç½® (Schedule) ---
on:
  schedule:
    # æ¯å¤© UTC 00:00 è¿è¡Œï¼Œå³åŒ—äº¬æ—¶é—´ (UTC+8) æ¯å¤©æ—©ä¸Š 8 ç‚¹
    - cron: '0 0 * * *'
  # ä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘ï¼Œæ–¹ä¾¿è°ƒè¯•
  workflow_dispatch:

# --- 2. è¿è¡Œçš„å·¥ä½œ (Jobs) ---
jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    # è®¾ç½®ç¯å¢ƒå˜é‡ (å¯é€‰ï¼Œä½†æ¨è)
    env:
      PYTHONIOENCODING: utf-8

    # --- 3. è¿è¡Œæ­¥éª¤ (Steps) ---
    steps:

    # æ­¥éª¤ A: æ£€å‡ºä»£ç 
    - name: Checkout repository
      uses: actions/checkout@v4

    # æ­¥éª¤ B: è®¾ç½® Python ç¯å¢ƒ
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        # ä½¿ç”¨ Python 3.10
        python-version: '3.10'

    # æ­¥éª¤ C: å®‰è£…ä¾èµ–
    - name: Install dependencies
      run: |
        # ä½ çš„è„šæœ¬ä¸­ä½¿ç”¨äº†ï¼šfeedparser
        pip install feedparser

    # æ­¥éª¤ D: æ‰§è¡Œ Python è„šæœ¬ (ä¿®æ­£: è„šæœ¬è·¯å¾„åœ¨ news/ ç›®å½•ä¸‹)
    - name: Run the Python script
      # ç¡®ä¿è·¯å¾„æ˜¯ç›¸å¯¹äºä»“åº“æ ¹ç›®å½•çš„æ­£ç¡®è·¯å¾„
      run: python ./news/rss_scraper.py

    # æ­¥éª¤ E: æäº¤æ›´æ–°åçš„æ–‡ä»¶ (ä¿®æ­£: ç¡®ä¿æäº¤çš„æ¶ˆæ¯å’Œç›®æ ‡åˆ†æ”¯æ­£ç¡®)
    - name: Commit and Push changes
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        # æäº¤çš„æ¶ˆæ¯
        commit_message: "ğŸ¤– Feat: Auto-fetch RSS news data (Scheduled Run)"
